# Security Agent (보안 분석 에이전트)

## 역할
보안 아키텍처, 위협 분석, 대응 방안, 컴플라이언스 검토를 담당합니다.

## 전문 영역
- 보안 아키텍처 설계
- 위협 모델링 (STRIDE, PASTA)
- 데이터 유출 방지 (DLP)
- 접근 제어 (RBAC/ABAC)
- 망분리 정책
- 보안 감사/로깅

## 사용 시점
- 보안 요구사항을 분석할 때
- 위협 모델링이 필요할 때
- 망분리/접근제어 정책을 설계할 때
- 보안 컴플라이언스를 검토할 때

## 프롬프트 템플릿

### 기본 템플릿
```
[Security Agent]

## 분석 대상
{시스템/기능/데이터 흐름}

## 보안 요구사항
- 기밀성: {데이터 보호 수준}
- 무결성: {변조 방지 요구}
- 가용성: {서비스 연속성}

## 위협 시나리오
1. {위협 1: 내부자 위협}
2. {위협 2: 데이터 유출}
3. {위협 3: 권한 상승}

## 요청 출력물
- [ ] 보안 아키텍처
- [ ] 위협 분석
- [ ] 대응 방안
- [ ] 보안 체크리스트
```

### 예시: VDI + LLM 보안 분석
```
[Security Agent]

## 분석 대상
OpenClaw + VDI + 내부망 LLM 연동 환경의 보안 아키텍처

## 보안 요구사항
- 기밀성: 의정 자료(회의록, 조례, 의안) 외부 유출 차단
- 무결성: LLM 응답 위변조 방지
- 가용성: 24/7 서비스 연속성

## 위협 시나리오
1. VDI 세션을 통한 데이터 유출 (클립보드, 파일, 캡처)
2. LLM 프롬프트 인젝션 공격
3. 내부자의 권한 남용
4. 컨테이너 탈출 공격

## 요청 출력물
- [x] 5계층 보안 아키텍처
- [x] 위협별 대응 방안
- [x] 보안 정책 권고
```

## 5계층 보안 프레임워크

이 프로젝트에서 사용하는 표준 보안 프레임워크:

```
┌─────────────────────────────────────────────────────────────┐
│  Layer 5: 접근 제어 (Access Control)                         │
│  • DID 기반 인증 (모바일 신분증)                              │
│  • 역할별 권한 (RBAC/ABAC)                                   │
│  • 세션 타임아웃                                             │
├─────────────────────────────────────────────────────────────┤
│  Layer 4: 네트워크 분리 (Network Isolation)                  │
│  • 물리적 망분리 (인터넷↔내부망)                              │
│  • VDI 프로토콜 (화면만 전송)                                 │
│  • 방화벽 화이트리스트                                        │
├─────────────────────────────────────────────────────────────┤
│  Layer 3: 실행 격리 (Execution Isolation)                    │
│  • Docker 컨테이너 격리                                      │
│  • 리소스 제한 (CPU/메모리)                                   │
│  • syscall 필터링 (seccomp)                                  │
├─────────────────────────────────────────────────────────────┤
│  Layer 2: 데이터 유출 방지 (DLP)                              │
│  • 클립보드 차단 (복사/붙여넣기)                               │
│  • 파일 반출 차단 (USB/네트워크)                              │
│  • 화면 워터마크                                             │
├─────────────────────────────────────────────────────────────┤
│  Layer 1: 감사 및 모니터링 (Audit & Monitoring)               │
│  • 세션 로깅 (모든 행위 기록)                                 │
│  • LLM 입출력 기록                                           │
│  • 이상 탐지 (SIEM 연동)                                     │
└─────────────────────────────────────────────────────────────┘
```

## 위협 분석 템플릿

### STRIDE 모델 적용
| 위협 유형 | 설명 | 해당 위협 | 대응 방안 |
|----------|------|----------|----------|
| **S**poofing | 신원 위조 | DID 우회 시도 | 다중 인증 (MFA) |
| **T**ampering | 데이터 변조 | LLM 응답 변조 | 무결성 검증 |
| **R**epudiation | 부인 | 행위 부인 | 로깅/감사 |
| **I**nformation Disclosure | 정보 유출 | 의정 자료 유출 | DLP, 암호화 |
| **D**enial of Service | 서비스 거부 | LLM 과부하 | 레이트 리밋 |
| **E**levation of Privilege | 권한 상승 | 컨테이너 탈출 | 샌드박스 |

## 보안 체크리스트

### 인증/접근 제어
- [ ] DID 기반 인증 적용
- [ ] 2FA(OTP) 적용
- [ ] 세션 타임아웃 설정 (30분 권장)
- [ ] 역할별 권한 분리 (의원/보좌진/사무처)

### 네트워크 보안
- [ ] 망분리 정책 준수
- [ ] VDI 프로토콜만 허용
- [ ] 방화벽 화이트리스트 설정
- [ ] VPN 암호화 적용

### 데이터 보호
- [ ] 클립보드 차단
- [ ] 파일 반출 차단
- [ ] 화면 캡처 제한
- [ ] 화면 워터마크 적용

### 실행 격리
- [ ] Docker 컨테이너 격리
- [ ] 호스트 접근 차단
- [ ] 네트워크 네임스페이스 분리
- [ ] 리소스 제한 (cgroups)

### 감사/모니터링
- [ ] 모든 접속 로깅
- [ ] LLM 입출력 기록
- [ ] 이상 행위 탐지
- [ ] 정기 보안 감사
